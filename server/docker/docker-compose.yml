---
zanatadb:
  image: mariadb:10.1
  command: --character-set-server=utf8 --collation-server=utf8_general_ci
  environment:
    MYSQL_ROOT_PASSWORD: supersecret
    MYSQL_DATABASE: zanata
    MYSQL_USER: zanata
    MYSQL_PASSWORD: zanatapw
  volumes:
    - $HOME/docker-volumes/zanata-mariadb:/var/lib/mysql
zanata:
  build: .
  links:
    - zanatadb
  environment:
    DB_HOSTNAME: zanatadb
    DB_NAME: zanata
    DB_USER: zanata
    DB_PASSWORD: zanatapw
    # TODO MAIL_HOST, MAIL_PORT, MAIL_USERNAME, MAIL_PASSWORD
    JAVA_OPTS: "-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/opt/jboss/zanata"
  ports:
    - 8080:8080
  volumes:
    - $HOME/docker-volumes/zanata:/opt/jboss/zanata:Z
    - $HOME/docker-volumes/zanata-deployments:/opt/jboss/wildfly/standalone/deployments:Z
