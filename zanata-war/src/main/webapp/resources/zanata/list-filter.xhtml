<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:composite="http://java.sun.com/jsf/composite"
  xmlns:s="http://jboss.org/schema/seam/taglib"
  xmlns:rich="http://richfaces.org/rich"
  xmlns:a4j="http://richfaces.org/a4j">

<composite:interface>
  <composite:attribute name="id" type="java.lang.String"
    shortDescription="id of component (java naming)" required="true"/>

  <composite:attribute name="placeholder" type="java.lang.String"
    shortDescription="placeholder text for input field" default=""/>

  <composite:attribute name="actionBean"
    type="org.zanata.ui.AbstractListFilter"
    shortDescription="action bean (org.zanata.action.AbstractListFilter)"
    required="true"/>

  <composite:attribute name="render" required="true"
    shortDescription="Ids of component to render after filter"/>

  <composite:attribute name="listId" required="true" type="java.lang.String"
    shortDescription="Id of the list to be clear before filter"/>

  <composite:attribute name="bottomPanel" default="false"
    type="java.lang.Boolean"
    shortDescription="is for bottom view"/>

  <composite:attribute name="iconClass" type="java.lang.String"
    shortDescription="css class for icon display" default=""/>

  <composite:attribute name="status" type="java.lang.String"
    shortDescription="Name of the request status component that will indicate the status of the Ajax request when filtering"/>

</composite:interface>
<composite:implementation>
  <a4j:jsFunction name="#{cc.attrs.id}FilterList"
    action="#{cc.attrs.actionBean.firstPage}" status="#{cc.attrs.status}"
    render="#{cc.attrs.id}-pager, #{cc.attrs.id}-page-info, #{cc.attrs.render}"
    limitRender="true"
    onbegin="clearHTML('#{rich:clientId(cc.attrs.listId)}')">
    <a4j:param name="val" assignTo="#{cc.attrs.actionBean.filter}"/>
  </a4j:jsFunction>

  <a4j:jsFunction name="#{cc.attrs.id}NextPage"
    action="#{cc.attrs.actionBean.nextPage}" status="#{cc.attrs.status}"
    render="#{cc.attrs.id}-page-info, #{cc.attrs.id}-pager, #{cc.attrs.render}"
    limitRender="true">
  </a4j:jsFunction>

  <a4j:jsFunction name="#{cc.attrs.id}PreviousPage"
    action="#{cc.attrs.actionBean.previousPage}" status="#{cc.attrs.status}"
    render="#{cc.attrs.id}-page-info, #{cc.attrs.id}-pager, #{cc.attrs.render}"
    limitRender="true">
  </a4j:jsFunction>

  <s:fragment rendered="#{!cc.attrs.bottomPanel}">
    <div class="form--search panel__search reveal__target--appear"
      id="#{cc.attrs.id}">
      <label for="#{cc.attrs.id}__input" class="form--search__label"></label>
      <input id="#{cc.attrs.id}__input" type="search" maxlength="255"
        placeholder="#{cc.attrs.placeholder}â€¦"
        onkeyup="filterList(this, #{cc.attrs.id}FilterList)"
        class="form--search__input js-reveal__target__input"/>
      <button class="button--link panel__search__cancel js-reveal__cancel"
        onclick="#{cc.attrs.id}FilterList('')"
        data-target="##{cc.attrs.id}">#{messages['jsf.Cancel']}
      </button>
    </div>
  </s:fragment>

  <s:div styleClass="panel__results">
    <s:div id="#{cc.attrs.id}-pager">
      <s:div styleClass="panel__results__type"
        rendered="#{not (cc.attrs.bottomPanel and cc.attrs.actionBean.totalRecords eq 0)}">
        <i class="i txt--neutral #{cc.attrs.iconClass}"></i>
      </s:div>
      <s:fragment
        rendered="#{cc.attrs.actionBean.totalRecords ge cc.attrs.actionBean.pageSize}">
        <ul class="panel__pager">
          <li>
            <button title="#{messages['jsf.pager.PreviousPage']}"
              class="panel__pager__button"
              disabled="#{cc.attrs.actionBean.allowsPreviousPage() ? '' : 'disabled'}"
              onclick="#{cc.attrs.id}PreviousPage()">
              <i class="i--huge i--arrow-left"></i>
            </button>
          </li>
          <li>
            <button title="#{messages['jsf.pager.NextPage']}"
              class="panel__pager__button"
              disabled="#{cc.attrs.actionBean.allowsNextPage() ? '' : 'disabled'}"
              onclick="#{cc.attrs.id}NextPage()">
              <i class="i--huge i--arrow-right"></i>
            </button>
          </li>
        </ul>
      </s:fragment>
    </s:div>
    <span class="txt--meta">
      <s:span id="#{cc.attrs.id}-page-info">
        <s:fragment
          rendered="#{not (cc.attrs.bottomPanel and cc.attrs.actionBean.totalRecords eq 0)}">
          <s:fragment
            rendered="#{cc.attrs.actionBean.totalRecords gt cc.attrs.actionBean.pageSize}">
            <strong>#{cc.attrs.actionBean.pageStartIdx+1}-#{cc.attrs.actionBean.pageEndIdx+1}</strong> of
            #{cc.attrs.actionBean.totalRecords}
          </s:fragment>
          <s:fragment
            rendered="#{cc.attrs.actionBean.totalRecords le cc.attrs.actionBean.pageSize}">
            <strong>#{cc.attrs.actionBean.totalRecords}</strong>
          </s:fragment>
        </s:fragment>
      </s:span>


      <s:fragment rendered="#{!cc.attrs.bottomPanel}">
        <button
          class="button--link panel__search__reset js-reveal__reset is-hidden"
          data-target="##{cc.attrs.id}"
          onclick="#{cc.attrs.id}FilterList('')"
          title="#{messages['jsf.ClearSearch']}">
          <i class="i--right i--cancel"></i>
        </button>
        <button class="button--link panel__search__button js-reveal__show"
          data-target="##{cc.attrs.id}">
          #{messages['jsf.Search']}<i class="i--right i--search"></i>
        </button>
      </s:fragment>
    </span>
  </s:div>
</composite:implementation>
</html>
